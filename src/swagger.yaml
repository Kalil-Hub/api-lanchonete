openapi: 3.0.0
info:
  title: API Lanchonete
  version: 1.0.0
  description: |
    API RESTful para gerenciamento de lanchonete, incluindo autenticação de clientes
    e administradores, cadastro de produtos, pedidos e controle via JWT.

servers:
  - url: http://localhost:3000/api/v1
    description: Ambiente local

tags:
  - name: Autenticação - Administrador
  - name: Autenticação - Cliente
  - name: Produtos
  - name: Clientes
  - name: Pedidos

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  schemas:
    AdminRegister:
      type: object
      required: [nome, email, senha]
      properties:
        nome: { type: string }
        email: { type: string }
        senha: { type: string }

    AdminLogin:
      type: object
      required: [email, senha]
      properties:
        email: { type: string }
        senha: { type: string }

    ClienteRegister:
      type: object
      required: [nome, email, senha, telefone]
      properties:
        nome: { type: string }
        email: { type: string }
        senha: { type: string }
        telefone: { type: string }

    ClienteLogin:
      type: object
      required: [email, senha]
      properties:
        email: { type: string }
        senha: { type: string }

    TokenResponse:
      type: object
      properties:
        token:
          type: string
          example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."

    Produto:
      type: object
      required: [nome, preco]
      properties:
        id: { type: string }
        nome: { type: string }
        descricao: { type: string }
        preco: { type: number }
        imagem: { type: string }

    Cliente:
      type: object
      properties:
        id: { type: string }
        nome: { type: string }
        email: { type: string }

    PedidoItem:
      type: object
      required: [produtoId, quantidade]
      properties:
        produtoId: { type: string }
        quantidade: { type: integer }

    Pedido:
      type: object
      properties:
        id: { type: string }
        clienteId: { type: string }
        itens:
          type: array
          items:
            $ref: "#/components/schemas/PedidoItem"
        total: { type: number }
        status: { type: string }

paths:

  ################################
  # AUTENTICAÇÃO - ADMIN
  ################################
  /auth/admin/register:
    post:
      tags: [Autenticação - Administrador]
      summary: Registrar administrador
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AdminRegister"
      responses:
        201:
          description: Administrador registrado

  /auth/admin/login:
    post:
      tags: [Autenticação - Administrador]
      summary: Login administrador
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AdminLogin"
      responses:
        200:
          description: Login bem-sucedido
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TokenResponse"

  ################################
  # AUTENTICAÇÃO - CLIENTE
  ################################
  /auth/cliente/register:
    post:
      tags: [Autenticação - Cliente]
      summary: Registrar cliente
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ClienteRegister"
      responses:
        201:
          description: Cliente criado

  /auth/cliente/login:
    post:
      tags: [Autenticação - Cliente]
      summary: Login cliente
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ClienteLogin"
      responses:
        200:
          description: Login OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TokenResponse"

  ################################
  # PRODUTOS
  ################################
  /produtos:
    get:
      tags: [Produtos]
      summary: Listar produtos
      responses:
        200:
          description: Lista de produtos

    post:
      tags: [Produtos]
      summary: Criar produto (ADMIN)
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Produto"
      responses:
        201:
          description: Produto criado

  /produtos/{id}:
    get:
      tags: [Produtos]
      summary: Buscar produto por ID
      parameters:
        - name: id
          in: path
          required: true
      responses:
        200:
          description: Produto encontrado
        404:
          description: Produto não encontrado

    put:
      tags: [Produtos]
      summary: Atualizar produto (ADMIN)
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
      responses:
        200:
          description: Produto atualizado

    delete:
      tags: [Produtos]
      summary: Deletar produto (ADMIN)
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
      responses:
        204:
          description: Produto deletado

  ################################
  # CLIENTES
  ################################
  /clientes:
    get:
      tags: [Clientes]
      summary: Listar clientes (ADMIN)
      security:
        - bearerAuth: []
      responses:
        200:
          description: Lista de clientes

    post:
      tags: [Clientes]
      summary: Criar cliente
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Cliente"
      responses:
        201:
          description: Cliente criado

  /clientes/{id}:
    get:
      tags: [Clientes]
      summary: Buscar cliente por ID (ADMIN)
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
      responses:
        200:
          description: Cliente encontrado
        404:
          description: Não encontrado

  ################################
  # PEDIDOS
  ################################
  /pedidos:
    get:
      tags: [Pedidos]
      summary: Listar pedidos (ADMIN)
      security:
        - bearerAuth: []
      responses:
        200:
          description: Lista de pedidos

    post:
      tags: [Pedidos]
      summary: Criar pedido (CLIENTE)
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                itens:
                  type: array
                  items:
                    $ref: "#/components/schemas/PedidoItem"
      responses:
        201:
          description: Pedido criado

  /pedidos/meus:
    get:
      tags: [Pedidos]
      summary: Listar pedidos do cliente logado
      security:
        - bearerAuth: []
      responses:
        200:
          description: Lista de pedidos do cliente

  /pedidos/{id}:
    put:
      tags: [Pedidos]
      summary: Atualizar pedido (ADMIN)
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
      responses:
        200:
          description: Pedido atualizado

    delete:
      tags: [Pedidos]
      summary: Deletar pedido (ADMIN)
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
      responses:
        204:
          description: Pedido deletado
